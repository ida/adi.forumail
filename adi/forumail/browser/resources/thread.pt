<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      metal:use-macro="context/main_template/macros/master">

    <metal:block fill-slot="main">
<ul class="thread"
    tal:define="thread nocall: view/getThread;
                getPortraitUrl nocall: view/getPortraitUrl;"
    tal:repeat="post thread">

    <li class="thread-post"
        tal:define="author post/Creator;
                    portrait_url python: getPortraitUrl(author)">
        
        <h2 class="thread-post-initial"
            tal:condition="repeat/post/start"
             tal:define="categories post/Subject">
            <span class="thread-title"
                  tal:content="post/Title" />
            <span class="thread-categories"
                  tal:repeat="cat categories">
                <span class="thread-category"
                      tal:content="cat" />
            </span>
        </h2>
        
        <div tal:content="portrait_url" />
        
        <span tal:content="author" />
        
        <span tal:content="post/CreationDate" />
        
        <div tal:content="structure post/getText" />
    </li>
</ul>
    </metal:block>

</html>

